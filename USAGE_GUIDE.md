# AI漏洞分析助手 - 使用指南

## 快速开始

### 第一步：编译插件

在Windows上运行：
```bash
compile.bat
```

或者使用Gradle：
```bash
gradle clean jar
```

或者使用Maven：
```bash
mvn clean package
```

### 第二步：加载插件到Burp Suite

1. 打开Burp Suite
2. 进入 `Extensions` -> `Installed`
3. 点击 `Add` 按钮
4. 选择 `Extension type` 为 `Java`
5. 选择编译好的JAR文件：
   - 使用compile.bat: `build\libs\ai-analyzer.jar`
   - 使用Gradle: `build\libs\ai-analyzer-1.0.0.jar`
   - 使用Maven: `target\ai-analyzer-1.0.0-jar-with-dependencies.jar`
6. 点击 `Next` 完成加载

### 第三步：配置通义千问API

1. 获取API Key：
   - 访问 https://dashscope.console.aliyun.com/
   - 登录阿里云账号
   - 开通DashScope服务
   - 创建API Key

2. 在Burp Suite中配置：
   - 找到 `AI分析` 标签页
   - 在 `API URL` 字段填入：`https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions`
   - 在 `API Key` 字段填入你的API Key

## 使用场景

### 场景1：SQL注入检测

1. 在Burp Suite中找到一个带参数的请求
2. 右键点击请求，选择 `发送到AI分析`
3. 在用户提示词中输入：
   ```
   请详细分析这个请求中是否存在SQL注入漏洞，包括：
   1. 哪些参数可能存在注入点
   2. 建议的测试payload
   3. 可能的数据库类型
   4. 绕过WAF的技巧
   ```
4. 点击 `开始分析`

### 场景2：XSS漏洞分析

用户提示词示例：
```
分析这个请求中的XSS攻击面：
1. 识别所有用户可控的输入点
2. 分析输出上下文（HTML、JavaScript、属性等）
3. 推荐针对性的XSS payload
4. 评估CSP绕过可能性
```

### 场景3：认证绕过分析

用户提示词示例：
```
检查这个请求的认证机制：
1. Token/Session的安全性
2. 是否存在越权访问风险
3. 认证绕过的可能性
4. 建议的测试方法
```

### 场景4：API安全评估

用户提示词示例：
```
评估这个API接口的安全性：
1. 参数验证是否充分
2. 是否存在IDOR漏洞
3. 批量操作的风险
4. 业务逻辑漏洞可能性
```

### 场景5：文件上传漏洞

用户提示词示例：
```
分析这个文件上传请求：
1. 文件类型检测机制
2. 可能的绕过方法
3. 路径遍历风险
4. 推荐的测试文件
```

## 高级技巧

### 1. 组合分析

可以在用户提示词中要求AI进行多维度分析：
```
请从以下角度全面分析这个请求：
1. 注入类漏洞（SQL、命令注入、LDAP等）
2. 业务逻辑漏洞
3. 认证授权问题
4. 敏感信息泄露
5. 推荐优先级最高的3个测试点
```

### 2. 上下文信息

提供更多上下文信息可以获得更准确的分析：
```
这是一个电商网站的订单提交接口，用户角色为普通会员。
请分析：
1. 是否可以修改价格
2. 是否可以越权查看他人订单
3. 优惠券逻辑是否存在问题
```

### 3. 针对性测试

针对特定漏洞类型进行深入分析：
```
假设这个应用使用MySQL数据库，magic_quotes已关闭。
请提供：
1. 5个不同的SQL注入payload
2. 每个payload的预期效果
3. 如何判断注入成功
```

## 注意事项

### 安全性

1. **敏感数据**：请求内容会发送到通义千问API，注意脱敏
2. **API Key保护**：不要在公共环境中暴露你的API Key
3. **数据留存**：了解通义千问的数据保留政策

### 成本控制

1. **Token消耗**：每次分析会消耗API tokens
2. **批量分析**：避免对大量请求进行自动化分析
3. **提示词优化**：简洁的提示词可以减少token消耗

### 准确性

1. **AI建议验证**：AI的建议需要人工验证
2. **误报可能**：AI可能产生误报，需要实际测试确认
3. **持续学习**：根据结果调整提示词，获得更好的分析效果

## 故障排除

### 问题1：插件加载失败

**解决方案**：
- 确认Java版本为21或更高
- 检查JAR文件是否完整
- 查看Burp Suite的Errors标签页

### 问题2：API调用失败

**解决方案**：
- 检查API Key是否正确
- 确认网络可以访问阿里云服务
- 查看Output标签页的错误信息

### 问题3：分析结果不准确

**解决方案**：
- 优化用户提示词，提供更多上下文
- 尝试不同的提问方式
- 将复杂请求拆分为多个小问题

### 问题4：响应时间过长

**解决方案**：
- 简化HTTP请求内容（删除不必要的headers）
- 缩短用户提示词
- 检查网络连接质量

## 示例工作流

### 完整的漏洞挖掘流程

1. **信息收集**
   - 使用Burp Spider爬取目标站点
   - 在Proxy History中筛选感兴趣的请求

2. **初步分析**
   - 右键发送请求到AI分析
   - 使用通用提示词进行初步评估

3. **深入测试**
   - 根据AI建议，在Repeater中构造测试payload
   - 观察响应，验证漏洞存在性

4. **漏洞确认**
   - 使用AI分析异常响应
   - 请求AI提供漏洞利用建议

5. **报告生成**
   - 整理AI分析结果
   - 结合实际测试结果编写报告

## 最佳实践

1. **渐进式分析**：先用简单提示词，再根据结果深入
2. **批量处理**：对相似请求使用相同的提示词模板
3. **结果归档**：保存有价值的分析结果作为知识库
4. **持续优化**：根据实际效果不断优化提示词
5. **人机结合**：AI建议+人工验证=最佳效果

## 更新日志

### v1.0.0 (2025-10-23)
- 初始版本发布
- 支持通义千问API集成
- 右键菜单功能
- 自定义提示词
- 友好的UI界面

## 反馈与支持

如有问题或建议，请通过以下方式反馈：
- 提交Issue
- 发送邮件
- 参与讨论

---

**祝你挖洞愉快！** 🎯

